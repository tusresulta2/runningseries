<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>Inscritos Carrera AJE C√≥rdoba - La Carrera de las Empresas - 16 noviembre 2025</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="carrera, cordoba, aje, running, run" name="keywords">
    <meta content="5K, 10K en individual, parejas o equipos de 4. Ven a correr el 16 de Noviembre a la Carrera AJE C√≥rdoba en el Parque Miraflores con una espectacular llegada con la Mezquita-Catedral de fondo. 10K Prueba puntuable para el Circuito de Carreras Populares de C√≥rdoba." name="description">
    <meta property="og:image" content="https://runningseries.es/2024/preview.png">
    <meta property="og:title" content="Inscritos Carrera AJE C√≥rdoba - La Carrera de las Empresas - 16 noviembre 2025" />
    <meta property="og:description" content="5K, 10K en individual, parejas o equipos de 4. Ven a correr el 16 de Noviembre a la Carrera AJE C√≥rdoba en el Parque Miraflores con una espectacular llegada con la Mezquita-Catedral de fondo. 10K Prueba puntuable para el Circuito de Carreras Populares de C√≥rdoba." />

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">
    <style>
        /* Estilos CSS B√ÅSICOS */
        body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: #c9071d;
        }

        #search-container {
        margin-bottom: 30px;
        padding: 20px;
        background-color: #ffffff;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        #search-input {
        width: 100%;
        padding: 12px 20px;
        margin: 8px 0;
        box-sizing: border-box;
        border: 2px solid #c9071d;
        border-radius: 4px;
        font-size: 16px;
        transition: border-color 0.3s;
        }

        #search-input:focus {
        border-color: #337ab7;
        outline: none;
        }
        /* ESTILO PARA EL CONTADOR */
        #record-count {
        margin-top: 10px;
        font-weight: bold;
        color: #333;
        font-size: 1.1em;
        }

        #results-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        justify-content: flex-start;
        }

        .card {
        background-color: #ffffff;
        border: 1px solid #ddd;
        border-left: 5px solid #c9071d; /* Color de acento */
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        padding: 15px;
        width: 320px; /* Ancho fijo para las tarjetas */
        min-width: 300px;
        box-sizing: border-box;
        }

        .card h3 {
        margin-top: 0;
        margin-bottom: 10px;
        color: #333;
        font-size: 1.2em;
        }

        .card p {
        margin: 5px 0;
        color: #666;
        line-height: 1.4;
        }

        .card p strong {
        color: #333;
        font-weight: 600;
        }

        .no-results {
        color: #d9534f;
        font-weight: bold;
        padding: 15px;
        }
    </style>
</head>
<body>

    <div id="search-container">
        <h1>üîç B√∫squeda de inscripciones SPG RunningSeries AJE C√≥rdoba 2025</h1>
        <input type="text" id="search-input" placeholder="Buscar por Nombre, Apellidos, Dorsal, Carrera o Club...">
        <div id="record-count"></div>
    </div>

    <div id="results-container">
    </div>
    <script>
        // üìù 1. Referencias a elementos del DOM
        const searchInput = document.getElementById('search-input');
        const resultsContainer = document.getElementById('results-container');
        const recordCount = document.getElementById('record-count');

        // Variable global para almacenar los datos una vez cargados
        let ALL_RUNNERS_DATA = [];

        // ‚öôÔ∏è 2. Funci√≥n de B√∫squeda
        function searchData(query) {
            const lowerCaseQuery = query.toLowerCase().trim();

            if (lowerCaseQuery === '') {
                // Si la b√∫squeda est√° vac√≠a, mostrar todos los resultados
                return ALL_RUNNERS_DATA;
            }

            // Filtra los datos
            const results = ALL_RUNNERS_DATA.filter(item => {
                for (const key in item) {
                    if (item.hasOwnProperty(key)) {
                        const value = item[key];
                        if (String(value).toLowerCase().includes(lowerCaseQuery)) {
                            return true;
                        }
                    }
                }
                return false;
            });

            return results;
        }

        // üñºÔ∏è 3. Funci√≥n para Renderizar los Resultados
        function renderResults(data) {
            resultsContainer.innerHTML = ''; // Limpia el contenedor
            const totalRecords = ALL_RUNNERS_DATA.length;
            const foundRecords = data.length;

            // Actualiza el contador de registros
            if (searchInput.value.trim() === '') {
                recordCount.textContent = `Mostrando ${totalRecords} registros totales.`;
            } else {
                recordCount.textContent = `Se encontraron ${foundRecords} de ${totalRecords} registros.`;
            }

            if (data.length === 0) {
                resultsContainer.innerHTML = '<p class="no-results">No se encontraron resultados que coincidan con la b√∫squeda.</p>';
                return;
            }

            data.forEach(item => {
                const card = document.createElement('div');
                card.classList.add('card');

                const modalidad = item["Tipo inscripci√≥n"].replace('Inscripci√≥n ','');
                const clubName = item.Club && item.Club.trim() !== '' ? item.Club : '';
                const year = new Date(item["Fecha Nacimiento"]);
                const sexo = item.Sexo === 'Hombre' ? 'M' : 'F';
                const team = item["Escoge el nombre que eleg√≠s como PAREJA"] && item["Escoge el nombre que eleg√≠s como PAREJA"].trim() != '' ? item["Escoge el nombre que eleg√≠s como PAREJA"] :
        (item["Escoge el nombre que eleg√≠s como EQUIPO"] && item["Escoge el nombre que eleg√≠s como EQUIPO"].trim() != '' ? item["Escoge el nombre que eleg√≠s como EQUIPO"] : '')

                const cardContent = `
                    <h3>${item.Nombre} ${item.Apellidos}</h3>
                    <p><strong>Dorsal:</strong> <span style="font-weight: bold; color: #d9534f;">${item.Dorsal}</span></p>
                    <p><strong>Carrera:</strong> ${item.Carrera}</p>
                    <p><strong>Modalidad:</strong> ${modalidad}</p>
                    <p><strong>A√±o:</strong> ${year.getFullYear()}</p>
                    <p><strong>Sexo:</strong> ${sexo}</p>

                    <p><strong>Team:</strong> ${team}</p>
                    <p><strong>Club:</strong> ${clubName}</p>
                    <p><strong>Empresa:</strong> ${item["Nombre de la Empresa que representas:"]}</p>
                `;

                card.innerHTML = cardContent;
                resultsContainer.appendChild(card);
            });
        }

        // üöÄ 4. Funci√≥n principal que maneja la b√∫squeda y el renderizado
        function handleSearch() {
            const query = searchInput.value;
            const results = searchData(query);
            renderResults(results);
        }

        // üíæ 5. Funci√≥n para cargar el JSON y inicializar la aplicaci√≥n
        async function loadDataAndInit() {
            try {
                // FETCH API para cargar el JSON desde el archivo local
                const response = await fetch('inscritos.json');

                if (!response.ok) {
                    throw new Error(`Error ${response.status}: Archivo no encontrado o error en el servidor.`);
                }

                // Asigna el JSON parseado a la variable global
                ALL_RUNNERS_DATA = await response.json();

                // Habilita el input de b√∫squeda
                searchInput.disabled = false;
                searchInput.placeholder = "Buscar por Nombre, Apellidos, Dorsal, Carrera, Club, Empresa...";

                // Inicializa la vista con todos los datos
                handleSearch();

                // Asigna el event listener una vez que los datos est√°n listos
                searchInput.addEventListener('input', handleSearch);

            } catch (error) {
                // Manejo de errores de carga
                resultsContainer.innerHTML = '<p class="no-results">‚ùå Error al cargar los datos. Verifica que el archivo **output.json** exista en la misma carpeta y que est√©s ejecutando la p√°gina en un servidor web.</p>';
                recordCount.textContent = '0 registros.';
                console.error('Error al iniciar la aplicaci√≥n:', error);
            }
        }

        // Inicia el proceso de carga
        loadDataAndInit();

    </script>
</body>
</html>